# ElasticSearch

## 1. 介绍

- Elasticsearch 是一个实时的分布式搜索分析引擎，它能让你以前所未有的速度和规模去探索你的数据。
- 它被用作全文检索、结构化搜索、分析以及这三个功能的组合

## 2. 特性

- 分配文档到不同的容器或分片 中，文档可以储存在一个或多个节点中
- 按集群节点来均衡分配这些分片，从而对索引和搜索过程进行负载均衡
- 复制每个分片以支持数据冗余，从而防止硬件故障导致的数据丢失
- 将集群中任一节点的请求路由到存有相关数据的节点
- 集群扩容时无缝整合新节点，重新分配分片以便从离群节点恢复

## 3. 集群

### 介绍

- ElasticSearch 的主旨是随时可用和按需扩容
- 扩容可以通过购买性能更强大(垂直扩容或纵向扩容)或者数量更多的服务器(水平扩容或横向扩容)来实现
- ElastiSearch 天生就是分布式的，它知道如何通过管理多节点来提高扩容性和可用性

### 空集群

- 如果我们启动了一个单独的节点，里面不包含任何的数据和索引，则称为一个空集群
- 一个运行中的 Elasticsearch 实例称为一个节点，而集群是由一个或者多个拥有相同 cluster.name 配置的节点组成，它们共同承担数据和负载的压力。
- 当有节点加入集群中或者从集群中移除节点时，集群将会重新平均分布所有的数据
- 当一个节点被选举成为主节点时，它将负责管理集群范围内的所有变更，例如增加、删除索引，或者增加、删除节点等
- 主节点并不需要涉及到文档级别的变更和搜索等操作
- 任何节点都可以成为主节点
- 当你在同一台机器上启动了第二个节点时，只要它和第一个节点有同样的 cluster.name 配置，它就会自动发现集群并加入到其中

### 请求流程

- 作为用户，我们可以将请求发送到 集群中的任何节点 ，包括主节点
- 每个节点都知道任意文档所处的位置，并且能够将我们的请求直接转发到存储我们所需文档的节点
- 无论我们将请求发送到哪个节点，它都能负责从各个包含我们所需文档的节点收集回数据，并将最终结果返回給客户端
- Elasticsearch 对这一切的管理都是透明的

### 集群健康

- green 所有的主分片和副本分片都正常运行。
- yellow 所有的主分片都正常运行，但不是所有的副本分片都正常运行。
- red 有主分片没能正常运行

```
curl -X GET "http://192.168.122.128:9201/_cluster/health?pretty"
```
